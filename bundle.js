(()=>{"use strict";var t;const n={board:t=[[null,null,null],[null,null,null],[null,null,null]],displayBoard:function(){t.forEach((function(t){}))},addMark:function(n,e,r){return null===t[n][e]&&(t[n][e]=r,!0)},checkWinner:function(){for(var n=0;n<3;n++)if(null!==t[n][0]&&t[n][0]===t[n][1]&&t[n][1]===t[n][2])return t[n][0];for(var e=0;e<3;e++)if(null!==t[0][e]&&t[0][e]===t[1][e]&&t[1][e]===t[2][e])return t[0][e];return null!==t[0][0]&&t[0][0]===t[1][1]&&t[1][1]===t[2][2]?t[0][0]:null!==t[0][2]&&t[0][2]===t[1][1]&&t[1][1]===t[2][0]?t[0][2]:null},checkDraw:function(){return t.every((function(t){return t.every((function(t){return null!==t}))}))}};function e(t,n){if(t){if("string"==typeof t)return r(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var l,o,a,u,i,c,d=function(t,n){return{name:t,mark:n}},f=function(t){var l=function(t,e){for(var r=0;r<3;r++)for(var l=0;l<3;l++)if(null===t[r][l]){if(t[r][l]=e,n.checkWinner()===e)return t[r][l]=null,[r,l];t[r][l]=null}return null},o=function(n){return l(n,"X"===t?"O":"X")},a=function(t){for(var n=[],e=0;e<3;e++)for(var r=0;r<3;r++)null===t[e][r]&&n.push([e,r]);return n.length>0?n[Math.floor(Math.random()*n.length)]:null};return{mark:t,makeMove:function(){if(n.checkWinner()||n.checkDraw())return null;var u=n.board.map((function(t){return function(t){if(Array.isArray(t))return r(t)}(n=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||e(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();var n})),i=["win","block","best","random"],c=i[Math.floor(Math.random()*i.length)];if("win"===c){var d=l(u,t);if(d)return d}if("block"===c){var f=o(u);if(f)return f}return"best"===c?function(n){var r=l(n,t);if(r)return r;var u,i,c=o(n);if(c)return c;if(null===n[1][1])return[1,1];for(var d=0,f=[[0,0],[0,2],[2,0],[2,2]];d<f.length;d++){var s=(i=2,function(t){if(Array.isArray(t))return t}(u=f[d])||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,l,o,a,u=[],i=!0,c=!1;try{if(o=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;i=!1}else for(;!(i=(r=o.call(e)).done)&&(u.push(r.value),u.length!==n);i=!0);}catch(t){c=!0,l=t}finally{try{if(!i&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(c)throw l}}return u}}(u,i)||e(u,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y=s[0],m=s[1];if(null===n[y][m])return[y,m]}return a(n)}(u):a(u)}}},s=(l=document.getElementById("game-board"),o=document.getElementById("result"),a=document.getElementById("game-start"),u=document.getElementById("back-to-menu"),i=function(t,n,e,r){if(n!==e&&t.target.classList.contains("cell")){var l=t.target.dataset.row,o=t.target.dataset.col;if("true"===t.target.getAttribute("data-filled"))return;void 0!==l&&void 0!==o&&(r(parseInt(l),parseInt(o)),c())}},{renderBoard:c=function(){l.innerHTML="",n.board.forEach((function(t,n){var e=document.createElement("div");e.classList.add("row"),t.forEach((function(t,r){var l=document.createElement("div");l.classList.add("cell"),l.dataset.row=n,l.dataset.col=r,l.textContent=t||"",null!==t&&l.setAttribute("data-filled","true"),e.appendChild(l)})),l.appendChild(e)}))},updateResult:function(t){o.textContent=t},blockCells:function(){document.querySelectorAll(".cell").forEach((function(t){t.removeEventListener("click",i),t.classList.add("disabled")}))},addClickListeners:function(t,n,e){l&&l.addEventListener("click",(function(r){return i(r,t,n,e)}))},showGameStartBlock:function(){a&&(a.style.display="block")},hideGameStartBlock:function(){a&&(a.style.display="none")},hideBoard:function(){l&&(l.style.display="none")},showBoard:function(){l&&(l.style.display="grid")},toggleBackToMenuButton:function(t){u&&(u.style.display=t?"block":"none")}});const y=s;function m(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,l,o,a,u=[],i=!0,c=!1;try{if(o=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;i=!1}else for(;!(i=(r=o.call(e)).done)&&(u.push(r.value),u.length!==n);i=!0);}catch(t){c=!0,l=t}finally{try{if(!i&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(c)throw l}}return u}}(t,n)||function(t,n){if(t){if("string"==typeof t)return v(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?v(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}var h,b,p,k,g,B=!1,E=!1;document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("player-vs-player"),e=document.getElementById("player-vs-computer");g=document.getElementById("restart-game");var r=document.getElementById("back-to-menu");g&&(g.style.display="none"),y.toggleBackToMenuButton(!1),r.addEventListener("click",(function(){y.hideBoard(),y.showGameStartBlock(),n.board.forEach((function(t){return t.fill(null)})),y.renderBoard(),y.updateResult(""),g&&(g.style.display="none"),y.toggleBackToMenuButton(!1),B=!1})),t.addEventListener("click",(function(){w(!1)})),e.addEventListener("click",(function(){w(!0)})),g&&g.addEventListener("click",(function(){g.style.display="none",y.showGameStartBlock(),n.board.forEach((function(t){return t.fill(null)})),y.renderBoard(),y.updateResult(""),B=!1,w(E)}))}));var w=function(t){E=t,b=d("Игрок 1","X"),p=E?f("O"):d("Игрок 2","O"),k=E?p:null,h=b,B=!1,n.board.forEach((function(t){return t.fill(null)})),y.renderBoard(),y.updateResult(""),y.hideGameStartBlock(),y.showBoard(),y.toggleBackToMenuButton(!0),y.addClickListeners(h,k,S),E&&(h=k,setTimeout((function(){var t=m(k.makeMove(),2),n=t[0],e=t[1];S(n,e),y.renderBoard()}),500)),B&&g&&(g.style.display="block")},S=function(t,e){if(!B&&n.addMark(t,e,h.mark)){y.renderBoard();var r=n.checkWinner();if(r){var l="X"===r?b.name:k?"Компьютер":p.name;return y.updateResult("".concat(l," выиграл!")),B=!0,void(g.style.display="block")}if(n.checkDraw())return y.updateResult("Ничья!"),B=!0,void(g.style.display="block");(h=h===b?p:b)!==k||B||setTimeout((function(){var t=m(k.makeMove(),2),n=t[0],e=t[1];null!==n&&null!==e&&(S(n,e),y.renderBoard())}),500)}}})();